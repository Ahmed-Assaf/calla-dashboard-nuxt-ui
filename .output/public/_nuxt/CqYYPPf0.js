import{_ as re}from"./Bl80ofdR.js";import{_ as P}from"./idVGbEIg.js";import{r as H,h as J,a8 as M,q as y,i as b,a4 as E,G as K,o as h,l as q,w as f,b as r,k as t,a as V,c as w,F as Q,B as W,d as ue,t as ie,j as N,C as X,a9 as de,H as ce,J as pe}from"./CST-ZKdJ.js";import{c as Y,d as Z,_ as ee,e as te}from"./BQvatdOu.js";import{_ as ae}from"./BgesNrwq.js";import{_ as me}from"./CmJefEmy.js";import{u as oe}from"./BW_eh0Ps.js";import"./DOaSUxXF.js";import"./DevvwYKm.js";import"./B5lnwlPY.js";import"./C298fiGN.js";import"./DeCzlx8H.js";import"./P6enAWVv.js";import"./BVbT1tgN.js";import"./D5w4h-Vr.js";import"./CB507DKx.js";import"./CxIZtCgj.js";import"./BVVV9AMk.js";const _e={class:"flex items-stretch gap-3"},be={key:0,class:"flex items-center gap-2 flex-wrap mt-4"},fe={__name:"attributesCard",props:{data:{type:Object,required:!0}},emits:["update","remove"],setup(I,{emit:u}){const v=I,l=H({attribute:null}),{t:x}=J(),B=M(),i=y([]),c=b(()=>Y({attribute:Z().required(` ${v.data.name} ${x("inputs.required")}`)})),{userInfo:p}=E(K()),{fetchData:F,resultData:U,loading:A}=oe();A.value=!1;const g=y([]),R=async()=>{g.value.length||await F({url:`provider/feature/${v.data.id}/options`,headers:{Authorization:`Bearer ${p.value.token}`},onSuccess:()=>{g.value=U.value}})},m=b(()=>{var e;return(e=g.value.find(d=>d.id===l.attribute))==null?void 0:e.name}),S=b(()=>{if(i.value.length){const e=[];for(const d of i.value){const _=g.value.find($=>$.id===d);_&&e.push({id:d,name:_.name})}return e}}),C=u,O=async()=>{i.value.includes(l.attribute)?B.add({description:`${x("general.already_chose")} ${m.value}`,timeout:3e3,color:"red"}):(i.value.push(l.attribute),B.add({description:`${x("general.added")} ${m.value}`,timeout:3e3,color:"primary"}),C("update",i.value),l.attribute=null)},j=()=>{C("remove")},G=e=>{i.value=i.value.filter(d=>d!==e),C("update",i.value)};return(e,d)=>{const _=X,$=P,z=ee,a=te,o=me,n=ae;return h(),q(n,{header:{title:v.data.name},class:"mb-5 h-fit"},{header:f(()=>[r(_,{icon:"i-heroicons-x-mark-16-solid",color:"red",square:"",ui:{rounded:"rounded-full"},size:"3xs",type:"button",onClick:j})]),default:f(()=>[r(a,{class:"space-y-4",state:t(l),schema:t(c),onSubmit:O},{default:f(()=>[r(z,{label:e.$t("inputs.select_attribute.label"),name:"attribute",class:"mb-0"},{default:f(()=>[V("div",_e,[r($,{modelValue:t(l).attribute,"onUpdate:modelValue":d[0]||(d[0]=s=>t(l).attribute=s),options:t(g),placeholder:e.$t("inputs.select_attribute.placeholder"),"value-attribute":"id","option-attribute":"name",loading:t(A),onOpen:R,class:"flex-1"},null,8,["modelValue","options","placeholder","loading"]),r(_,{type:"submit",icon:"i-heroicons-plus-16-solid",disabled:!t(l).attribute,class:"rounded-xl"},null,8,["disabled"])])]),_:1},8,["label"])]),_:1},8,["state","schema"]),t(i).length?(h(),w("div",be,[(h(!0),w(Q,null,W(t(S),s=>(h(),q(o,{color:"white",variant:"solid",key:s,ui:{base:"shadow-card",size:{sm:"px-2 py-2"},color:{white:{solid:"ring-0 text-textBaseColor"}}}},{default:f(()=>[ue(ie(s.name)+" ",1),r(_,{icon:"i-heroicons-x-mark-16-solid",color:"red",square:"",ui:{base:"ms-3",rounded:"rounded-full"},size:"3xs",type:"button",onClick:T=>G(s.id)},null,8,["onClick"])]),_:2},1024))),128))])):N("",!0)]),_:1},8,["header"])}}},he={class:"grid grid-cols-12"},ve={class:"col lg:col-span-7 md:col-span-9 col-span-12 mb-8"},ge={class:"flex items-stretch gap-3"},ze={__name:"attributes",setup(I){const{t:u}=J(),v=de(),l=ce(),x=M(),B=b(()=>v.query.action!=="create"),i=b(()=>B.value?[{label:u("product.plural"),to:l({name:"products"})},{label:u("product.edit")},{label:u("product.attribute.plural.this")}]:[{label:u("product.plural"),to:l({name:"products"})},{label:u("product.create_1")},{label:u("product.attribute.plural.this")}]),c=H({attribute:null}),p=y([]),F=b(()=>Y({attribute:Z().required(u("inputs.select_attribute.required"))})),{userInfo:U}=E(K()),{fetchData:A,resultData:g,loading:R}=oe();R.value=!1;const m=y([]),S=y(!1),C=async()=>{S.value=!0,m.value.length||await A({url:"provider/features",headers:{Authorization:`Bearer ${U.value.token}`},onSuccess:()=>{m.value=g.value}}),S.value=!1},O=b(()=>{var a;return(a=m.value.find(o=>o.id===c.attribute))==null?void 0:a.name}),j=b(()=>{if(p.value.length){const a=[];for(const o of p.value){const n=m.value.find(s=>s.id===o);n&&a.push({id:o,name:n.name})}return a}}),G=async()=>{p.value.includes(c.attribute)?x.add({description:`${u("general.already_chose")} ${O.value}`,timeout:3e3,color:"red"}):(p.value.push(c.attribute),x.add({description:`${u("general.added")} ${O.value}`,timeout:3e3,color:"primary"}),c.attribute=null)},e=y([]),d=(a,o)=>{const n={feature_id:a,options_ids:o};if(e.value.length){const s=e.value.find(D=>D.feature_id===a);e.value.includes(s)?n.options_ids.length?(e.value.splice(e.value.indexOf(s),1),e.value.push(n)):e.value.splice(e.value.indexOf(s),1):e.value.push(n)}else n.options_ids.length&&e.value.push(n)},_=a=>{e.value=e.value.filter(o=>o.feature_id!==a),p.value=p.value.filter(o=>o!==a)},$=y(!1),z=async()=>{$.value=!0,await A({url:"provider/products/feature-add-or-update",method:"POST",headers:{Authorization:`Bearer ${U.value.token}`},body:{features:JSON.stringify(e.value),product_id:v.params.id},getSuccess:!0,onSuccess:()=>{pe(l({name:"products-id-groups",params:{id:v.params.id}}))}}),$.value=!1};return(a,o)=>{const n=re,s=P,T=X,D=ee,se=te,le=ae,ne=fe;return h(),w("div",null,[r(n,{title:t(i)},null,8,["title"]),V("div",he,[V("div",ve,[r(le,{class:"h-fit mb-5"},{default:f(()=>[r(se,{class:"space-y-4",state:t(c),schema:t(F),onSubmit:G},{default:f(()=>[r(D,{label:a.$t("inputs.select_attribute.label"),name:"attribute",class:"mb-0"},{default:f(()=>[V("div",ge,[r(s,{modelValue:t(c).attribute,"onUpdate:modelValue":o[0]||(o[0]=k=>t(c).attribute=k),options:t(m),placeholder:a.$t("inputs.select_attribute.placeholder"),"value-attribute":"id","option-attribute":"name",loading:t(S),onOpen:C,class:"flex-1"},null,8,["modelValue","options","placeholder","loading"]),r(T,{type:"submit",variant:"outline",label:a.$t("inputs.select_attribute.label"),disabled:!t(c).attribute,class:"rounded-xl"},null,8,["label","disabled"])])]),_:1},8,["label"])]),_:1},8,["state","schema"])]),_:1}),t(p).length?(h(!0),w(Q,{key:0},W(t(j),k=>(h(),q(ne,{key:k.id,data:k,onUpdate:L=>d(k.id,L),onRemove:L=>_(k.id)},null,8,["data","onUpdate","onRemove"]))),128)):N("",!0),t(e).length?(h(),q(T,{key:1,type:"button",label:a.$t("product.group.plural.add"),class:"rounded-xl",size:"xl",loading:t($),onClick:z},null,8,["label","loading"])):N("",!0)])])])}}};export{ze as default};
